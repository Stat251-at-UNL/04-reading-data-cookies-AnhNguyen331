---
title: "Chocolate Chip Cookies"
execute:
  error: true
author: "Anh Nguyen"
output: html_document
---

## Reading In the Data

First, read in the CSV data of cookie ingredients. Make sure that your end-result data has appropriate types for each column - these should match the types provided in the documentation in the README.md file.

```{r}
choc_chip_recipe_r <- read.csv("choc_chip_cookie_ingredients.csv", header = TRUE)

install.packages("ggplot2")
library(ggplot2)
install.packages("reticulate")
library(reticulate)
py_require("pandas")
py_require("matplotlib")
```

```{python}
import pandas as pd
choc_chip_recipe_py = pd.read_csv('choc_chip_cookie_ingredients.csv')
```

## Exploratory Data Analysis

Exploratory data analysis is the process of getting familiar with your dataset. To get started, [this blog post](https://www.mrdbourke.com/a-gentle-introduction-to-exploratory-data-analysis/) provides a nice checklist to get you thinking:

> 1.  What question(s) are you trying to solve (or prove wrong)?
> 2.  What kind of data do you have and how do you treat different types?
> 3.  What's missing from the data and how do you deal with it?
> 4.  Where are the outliers and why should you care about them?
> 5.  How can you add, change or remove features to get more out of your data?

### Generating Questions

Generate at least 5 questions you might explore using this database of cookie ingredients.

1.  Which recipe will give the most cookies in one batch?
2.  How often do recipes include extras like nuts, oats, or different types of chocolate?
3.  What are the most common ingredients among the recipe?
4.  Can ingredient data be used to predict whether a recipe is labeled as chewy, crispy, or soft?
5.  Do cookies with extra add-ins (like nuts or oats) tend to have longer ingredient lists?

### Skimming the Data

One thing we often want to do during EDA is to examine the quality of the data - are there missing values? What quirks might exist in the dataset?

The `skimr` package in R, and the similar `skimpy` package in python (which has a much better name, in my opinion), can help provide visual summaries of the data.

Install both packages, and read the package documentation ([R](https://cran.r-project.org/web/packages/skimr/vignettes/skimr.html), [Python](https://pypi.org/project/skimpy/)).

\[Part 1\] Use each package and generate summaries of your data that require the use of at least some non-default options in each package's `skim` function.

```{r}
install.packages("skimr")
library(skimr)
library(dplyr)


skim(choc_chip_recipe_r)
py_require(c("skimpy"))
```

```{python}
from skimpy import skim
skim(choc_chip_recipe_py)
```

\[Part 2\] Write 1-2 sentences about what you can tell from each summary display you generate. Did you discover anything new about the data?

**R(skimr) summary:**\
The skimr output shows the dataset has no missing values and a mix of numeric and text columns. It also suggests that ingredient information isn't fully standardized, since quantities and description are stored in a different format.

**Python(skimpy) summary:**\
The skimpy summary makes it easier to see how spread out the data is, especially for quantity and ratio values, which vary a lot and include some extreme values. It also shows that ingredient descriptions can be very long, meaning some important details are buried in text instead of clean columns. \### Generating Tables

Another useful technique for exploratory data analysis is to generate summary tables. You may want to use the `dplyr` package in R (`group_by` or `count` functions), as well as the `groupby` and `count` methods in Pandas. [Python example](https://sparkbyexamples.com/pandas/pandas-groupby-count-examples/), [R example](https://dplyr.tidyverse.org/reference/count.html)

\[Part 1\] Using R and Python, generate a table that shows what **proportion** of recipes contain each type of ingredient, for the most common 20 ingredients.

```{r}
library(dplyr)
total_recipe <- n_distinct(choc_chip_recipe_r$Recipe_Index)

top20_r <- choc_chip_recipe_r %>%
  distinct(Recipe_Index, Ingredient)%>%
  count(Ingredient, sort = TRUE) %>%
  mutate(proportion = n / total_recipe) %>%
  slice_head(n=20)

top20_r
         
```

```{python}
total_recipes = choc_chip_recipe_py["Recipe_Index"].nunique()

top20_py = (
  choc_chip_recipe_py[["Recipe_Index", "Ingredient"]]
  .drop_duplicates()
  .groupby("Ingredient")
  .count()
  .sort_values("Recipe_Index", ascending = False)
)
top20_py["proportion"] = top20_py["Recipe_Index"] / total_recipes

top20_py = top20_py.head(20)

top20_py
```

\[Part 2\] Print out a character string that lists all of the ingredients that do not appear in at least 20 recipes.

```{r}
rare_ingredients_r <- choc_chip_recipe_r %>%
  distinct(Recipe_Index, Ingredient)%>%
  count(Ingredient) %>%
  filter(n<20) %>%
  pull(Ingredient)
cat(paste(rare_ingredients_r, collapse = "\n "))
```

```{python}
rare_ingredients_py = (
  choc_chip_recipe_py[["Recipe_Index", "Ingredient"]]
  .drop_duplicates()
  .groupby("Ingredient")
  .nunique()
)
rare_list = rare_ingredients_py[rare_ingredients_py["Recipe_Index"] < 20].index.tolist()

print("\n".join(rare_list))
```

(Delete this note, but you can include data values inline in markdown text by using backticks, at least in R. For instance, here is R's built in value for pi: `r pi`. Unfortunately, this doesn't work in python using the knitr markdown engine, but you can print the list out in python anyways using a code chunk.)

### Visualization

Using whatever plotting system you are comfortable with in R or python, see if you can create a couple of useful exploratory data visualizations which address one of the questions you wrote above - or another question which you've come up with as you've worked on this assignment.

\[Part 1\] Create at least one plot (it doesn't have to be pretty) that showcases an interesting facet of the data.

```{r}

ggplot(top20_r, aes(x = reorder(Ingredient, proportion), 
                              y = proportion)) +
  geom_col() +
  coord_flip() +
  labs(title = "Proportion of Recipes Containing Each Ingredient",
       x = "Ingredient",
       y = "Proportion of Recipes")

```

```{python}
import matplotlib.pyplot as plt
plt.figure()
top20_py.plot(kind="bar")
plt.title("Top 20 Most Common Ingredients")
plt.ylabel("Number of Recipes")
plt.xlabel("Ingredient")
plt.xticks(rotation=90)
plt.tight_layout()
plt.show()
```

\[Part 2\] Write 2-3 sentences about what you can learn from that plot and what directions you might want to investigate from here.

The plot shows most chocolate chip cookies recipes rely on the same basic ingredients like egg, vanilla, all purpose flour, and baking soda. After those, the numbers drop pretty fast, which means the main differences between recipes come from extra add-ins like nuts or different types of chocolate. It would be interesting to look at whether certain ingredients are linked to higher ratings or if unique ingredients make a recipe stand out more.
